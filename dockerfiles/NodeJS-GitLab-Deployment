# NodeJS (GitLab-Deployment)
#
# VERSION               0.0.2

# Base from digitallyseamless/nodejs:arch
FROM      digitallyseamless/nodejs:arch

# Author: Digitally Seamless
MAINTAINER Digitally Seamless <docker@digitallyseamless.com>

# Install GitLab Deployment SSH keys
RUN bash -c 'mkdir -p /root/.ssh && echo -e "-----BEGIN RSA PRIVATE KEY-----\n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\nr34dAoIBAQDXU2AGRBVbWc4GjMYhX/6qJIJUhWOiV7kO+MxAgfnv1qX60bEWwi8G\nSl0aty7K+CWL5kQaFo7D428pOE1y/y1ht14hPfYKIU3kYI5bA0LzlaWx/yCmlU83\nhlR+7BQ21LgYruryn32czLkyuzC5LtAgJrDZWangTf5kCo2MzhmrX3mrEaxHFc5P\nPRvkt5GnuB/agv5sPTJNKWQqb/1ttnoAoIKrC98+3Ec//6eBS70Kx+R1+AuEMFcK\nF1J/zo3pm5gjEX9srz11/94zH9VNAocDPDRs7n0v1udQmSLPyvayGTevhmPgXF7u\nnBNU0q32wJNDbvJGsHoCJmiSgesQJVuZAoIBAQDUVoo8tf7CMD83aBWk6uuL9yCI\nlMjWKnPPUbB7arOkyQ7EtlenpmD6v+Zxq2C+Yb0/H9usiVJ20VLGupKmmGCugNZT\nMtui3qPBQfRTfvxsZxOeqGmz+MyFZ7ahKnkvNV7PQQbm+ZeRqB4zt6dcmT3fUdaa\n6IpTmW/UmiA4Q1Q6yde61O0jNBAaqUKxLpszYTBK87EQaeN5lW3d362vH0jK+BiZ\nUMedOOOopTtzXkMkcUrc8VBxU9fSiJD+XsGRuvvK/VKWrLmVnEiatJe5e7aRXlP4\nuiBnJ/wey/21+c/zzE7vIGOOQEWuuoWT/ypOowajlLul3rpvpBbLbzk77h+y\n-----END RSA PRIVATE KEY-----" > /root/.ssh/id_rsa && echo "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDPH6nT3Mk8zRx1YwpbPK0gmBXqU7wWX3eUi7Lbf6Sd/Un0axPC6J/3WiMTZJbxzRQI+Civu0RVWDd/FTsQMTfUh7NKZM4oYj+ROyaoW7f3dzgRrWRKJy/ffxMkRmqu6Iy38pITe9GhY8eOoOhmQIBuzMoIqM9DIw7ZICZ57wXWlBjU7LXNiQVIO5WUVbWBbVqO/1SuXUYe7J8iEeIm16WfvAjOtUlNu3XmLoohhkOWMx41tPKTFpVLWph5yJK3dgMgEc++U9oEAQ+IHAQBYDO8/8CV69ay+wTymQl8DdGvpHZmVcVFpdl5EAOEs3K7hnUAepomJ7fZ5h4HEVTOi27K6aq4tSb/c2cZPrmU+JfSslWoEcKpeeFQuYiULGZAGR4vp1+9ouL5ctEGUh15XjgVKSjqdT+zyJjwl8Sa9KRYJIEJbs9l6uSz2kNl9w8/T6IIWCYBANnTBDRosPnXnFUVkiyvVBWRjvVOkzyak8Db1Zqa37nBh4rvdSC5GC0445pK2hZ730wfp5mqc5HISt3lBUAdtexahuVQJC9nEOpvUaBn8lTZkQum9ktQwZPB9LvO6/jhjns/C0UnmgMtAflvdOztevtAcBphx1yHrK3I/QjKW8O2pOV5jZt+/ZTmkmf2Kd6Rkowl9pP1FV6f7g0Z+LSXhUjMyT5VqSH0vNLoQw==" > /root/.ssh/id_rsa.pub && chmod -R 600 /root/.ssh'

# Add GitLab Server to known_hosts
RUN bash -c 'echo "[git.digitallyseamless.com]:2222 ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBG0T4uEp3nwNV2eM2HO2ORGi0/iykvfLBRgBukPt+EsSqYjDxKRLZLfbfgPQFByVmVz4b//nMUvN/4nx80SONy4=" >> /root/.ssh/known_hosts'